/* --- CÀI ĐẶT CƠ BẢN & CHỐNG LỖI GIAO DIỆN --- */
* {
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent; /* Bỏ hiệu ứng xám khi chạm trên mobile */
}

html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%; /* Sử dụng height 100% thay vì vh để ổn định hơn */
    overflow: hidden; /* Ngăn cuộn toàn trang */
    font-family: "Be Vietnam Pro", sans-serif; /* Font tiếng Việt đẹp */
    background-color: #000;
}

/* --- LAYOUT CHÍNH SỬ DỤNG CSS GRID (SIÊU ỔN ĐỊNH) --- */
.mobile-screen {
    width: 100%;
    height: 100%;
    display: grid;
    /* Chia màn hình thành 3 hàng: header (auto), content (1fr), footer (auto) */
    grid-template-rows: auto 1fr auto; 
    background-color: #fff;
    overflow: hidden; /* Rất quan trọng */
}

/* --- HEADER --- */
.chat-header {
    display: flex;
    align-items: center;
    background: #23294d;
    color: #fff;
    padding: 10px 10px;
    z-index: 10;
    /* Đây là hàng đầu tiên trong grid */
}

.back-btn {
    display: flex;
    align-items: center;
    background: transparent;
    border: none;
    color: #fff;
    font-size: 16px;
    font-weight: 700;
    cursor: pointer;
    padding: 8px;
    border-radius: 8px;
}
.back-btn:active {
    background-color: rgba(255, 255, 255, 0.1);
}
.back-btn svg {
    margin-right: 2px;
}

.chat-title {
    flex-grow: 1;
    text-align: center;
    font-size: 18px;
    font-weight: 700;
    padding-right: 50px; /* Bù lại không gian cho nút back */
}

/* --- KHU VỰC CHAT (KHẮC PHỤC LỖI) --- */
.chat-area-wrapper {
    /* Đây là hàng thứ hai trong grid (1fr), sẽ chiếm hết không gian còn lại */
    overflow: hidden; /* Bắt buộc để con của nó (chat-area) không tràn ra ngoài */
    position: relative;
}

.chat-area {
    height: 100%; /* Lấp đầy cha của nó (.chat-area-wrapper) */
    overflow-y: auto; /* CHỈ khu vực này có thanh cuộn */
    padding: 15px 10px;
    background-image: url('../images/img_memory/a3.jpg'); /* Đảm bảo đường dẫn đúng */
    background-size: cover;
    background-position: center;
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch; /* Tối ưu cuộn trên iOS */
}

/* --- TIN NHẮN --- */
.message-wrapper {
    display: flex;
    align-items: flex-end;
    margin-bottom: 10px;
    animation: fadeInUp 0.4s ease-out;
}
.message-wrapper.sent {
    justify-content: flex-end;
    flex-direction: row-reverse;
}

.timestamp {
    font-size: 11px;
    color: #999;
    margin: 0 8px;
    margin-bottom: 2px;
}

.message-bubble {
    max-width: 80%;
    padding: 10px 15px;
    border-radius: 18px;
    line-height: 1.5;
    word-wrap: break-word;
    font-size: 16px;
}

.message-wrapper.sent .message-bubble {
    background-color: #35a500;
    color: #fff;
}

@keyframes fadeInUp {
    from { opacity: 0; transform: translateY(15px); }
    to { opacity: 1; transform: translateY(0); }
}

/* --- FOOTER --- */
.chat-footer {
    /* Đây là hàng thứ ba trong grid (auto) */
    display: flex;
    align-items: center;
    padding: 8px 10px;
    gap: 12px;
    background-color: #fff;
    border-top: 1px solid #ddd;
    /* Quan trọng: chừa khoảng trống cho thanh home của iPhone */
    padding-bottom: calc(8px + env(safe-area-inset-bottom));
}

.footer-icon {
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    color: #007aff;
    flex-shrink: 0;
}

.text-input-placeholder {
    flex-grow: 1;
    height: 36px;
    background-color: #f0f2f5;
    border-radius: 18px;
    padding: 0 15px;
    display: flex;
    align-items: center;
    color: #8a8d91;
    font-size: 16px;
}

/* --- Icon SVG cho footer --- */
.camera-icon { background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23007aff"><path d="M20 4h-3.17L15 2H9L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V6h4.05l1.83-2h4.24l1.83 2H20v12zM12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0 8c-1.65 0-3-1.35-3-3s1.35-3 3-3 3 1.35 3 3-1.35 3-3 3z"/></svg>') center/contain no-repeat; }
.gallery-icon { background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23007aff"><path d="M22 16V4c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2zm-11-4l2.03 2.71L16 11l4 5H8l3-4zM2 6v14c0 1.1.9 2 2 2h14v-2H4V6H2z"/></svg>') center/contain no-repeat; }
.smiley-icon { display: none; }
.like-icon { background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23007aff"><path d="M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3zm-4.4 15.55l-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05z"/></svg>') center/contain no-repeat; }